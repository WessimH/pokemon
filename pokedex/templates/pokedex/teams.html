{% extends 'pokedex/base.html' %} {% block content %}
<div class="container mx-auto py-10 px-4">
    <div class="mb-8">
        <h1 class="text-4xl font-extrabold text-slate-800 mb-2">Mes √âquipes</h1>
    </div>

    <div class="flex justify-between items-center mb-8">
        <div class="flex gap-3 overflow-x-auto pb-2">
            {% for team in teams %}
            <a
                href="?team={{ team.position }}"
                class="px-6 py-3 font-bold text-sm whitespace-nowrap rounded-xl transition-all transform hover:scale-105 {% if team.position == selected_team_position %} bg-red-600 text-white shadow-lg border-2 border-red-700 {% else %} bg-white text-slate-700 shadow-md border-2 border-slate-200 hover:bg-slate-50 {% endif %}"
            >
                {{ team.name }}
            </a>
            {% endfor %}
        </div>

        <!-- renommer l'equipe (compact) -->
        <div>
            <form method="post" class="flex gap-2 items-center">
                {% csrf_token %}
                <input type="hidden" name="action" value="rename" />
                <input
                    type="text"
                    id="team_name"
                    name="team_name"
                    value="{{ selected_team.name }}"
                    maxlength="100"
                    class="w-40 px-3 py-1 border border-slate-300 rounded-md focus:border-red-600 focus:outline-none text-sm font-semibold text-slate-800"
                    placeholder="Nom de l'√©quipe"
                    aria-label="Nom de l'√©quipe"
                />
                <button
                    type="submit"
                    class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-md text-sm font-bold transition transform hover:scale-105"
                >
                    Renommer
                </button>
            </form>
        </div>
    </div>

    <!-- slots de l'√©quipe -->
    <div class="mb-8 bg-white rounded-2xl shadow-lg p-6 border-2 border-slate-200">
        <div class="flex justify-end mb-4">
            {% if team_pokemons.count == 5 %}
            <div class="bg-green-100 text-red-700 px-3 py-1 rounded-full text-sm font-bold">
                {{ team_pokemons.count }}/5
            </div>
            {% else %}
            <div class="bg-red-100 text-red-700 px-3 py-1 rounded-full text-sm font-bold">
                {{ team_pokemons.count }}/5
            </div>
            {% endif %}
        </div>

        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
            <!-- Les Pok√©mon dans l'√©quipe -->
            {% for pokemon in team_pokemons %}
            <div
                class="bg-white rounded-2xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-2 overflow-hidden border-2 border-slate-100 relative group"
            >
                <div
                    class="absolute top-2 right-2 bg-slate-800 text-white text-xs font-bold px-2 py-1 rounded-full z-10 shadow-sm"
                >
                    Niv. {{ pokemon.level }}
                </div>
                <form method="post" class="w-full">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="remove_pokemon" />
                    <input type="hidden" name="pokemon_id" value="{{ pokemon.id }}" />
                    <button type="submit" class="w-full text-left p-0 m-0 focus:outline-none">
                        <div class="bg-slate-50 p-4 flex justify-center items-center h-32 relative">
                            <div
                                class="absolute w-20 h-20 bg-white rounded-full opacity-50 blur-xl"
                            ></div>

                            <img
                                src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/{{ pokemon.pokemon_id }}.png"
                                alt="{{ pokemon.name }}"
                                class="w-24 h-24 object-contain drop-shadow-md group-hover:scale-110 transition duration-300 z-10"
                            />
                        </div>

                        <div class="p-4 text-center bg-white">
                            <p class="text-[10px] text-gray-400 font-bold tracking-widest mb-1">
                                #{{ pokemon.pokemon_id }}
                            </p>

                            <h3
                                class="text-lg font-extrabold text-slate-800 capitalize leading-tight truncate"
                            >
                                {{ pokemon.name }}
                            </h3>
                        </div>
                    </button>
                </form>
            </div>
            {% endfor %}

            <!-- Slots vides -->
            {% for i in "12345" %} {% if forloop.counter > team_pokemons.count %}
            <div
                class="bg-gradient-to-br from-gray-100 to-gray-200 rounded-xl p-4 border-2 border-dashed border-gray-300 flex items-center justify-center min-h-32"
            >
                <p class="text-gray-400 font-bold text-center">Vide</p>
            </div>
            {% endif %} {% endfor %}
        </div>
    </div>

    <!-- liste des pokemon captur√©s -->
    {% if available_pokemons %}
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6">
        {% for pokemon in available_pokemons %}
        <div
            class="bg-white rounded-2xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-2 overflow-hidden border-2 border-slate-100 relative group"
        >
            <div
                class="absolute top-2 right-2 bg-slate-800 text-white text-xs font-bold px-2 py-1 rounded-full z-10 shadow-sm"
            >
                Niv. {{ pokemon.level }}
            </div>
            <form method="post" class="w-full">
                {% csrf_token %}
                <input type="hidden" name="action" value="add_pokemon" />
                <input type="hidden" name="pokemon_id" value="{{ pokemon.id }}" />
                <button type="submit" class="w-full text-left p-0 m-0 focus:outline-none">
                    <div class="bg-slate-50 p-4 flex justify-center items-center h-32 relative">
                        <div
                            class="absolute w-20 h-20 bg-white rounded-full opacity-50 blur-xl"
                        ></div>

                        <img
                            src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/{{ pokemon.pokemon_id }}.png"
                            alt="{{ pokemon.name }}"
                            class="w-24 h-24 object-contain drop-shadow-md group-hover:scale-110 transition duration-300 z-10"
                        />
                    </div>

                    <div class="p-4 text-center bg-white">
                        <p class="text-[10px] text-gray-400 font-bold tracking-widest mb-1">
                            #{{ pokemon.pokemon_id }}
                        </p>

                        <h3
                            class="text-lg font-extrabold text-slate-800 capitalize leading-tight truncate"
                        >
                            {{ pokemon.name }}
                        </h3>
                    </div>
                </button>
            </form>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div
        class="flex flex-col items-center justify-center py-20 bg-white/10 rounded-3xl backdrop-blur-sm border-2 border-dashed border-white/30 text-center"
    >
        <div class="text-6xl mb-4">üï∏Ô∏è</div>
        <p class="text-white text-xl font-bold mb-4">Ton PC est vide !</p>
        <p class="text-red-100 mb-6 max-w-md">Va explorer le monde pour agrandir ta collection.</p>
        <a
            href="{% url 'index' %}"
            class="bg-yellow-400 hover:bg-yellow-500 text-red-900 px-8 py-3 rounded-full font-bold shadow-lg transition transform hover:scale-105 border-b-4 border-yellow-600"
        >
            Partir chasser des Pok√©mons
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
